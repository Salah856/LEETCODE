class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        clean = set(range(len(graph))) - set(initial)
        def dfs(i):
            seen.add(i)
            [dfs(j) for j, v in enumerate(graph[i]) if v and j in clean and j not in seen]
        
        inffect = defaultdict(list)
        for i in initial:
            seen = set()
            dfs(i)
            for j in seen - {i}:
                inffect[j] += i,
                
        unique = Counter(x for k, v in inffect.items() for x in v if len(v) == 1)
        return unique and min(unique, key=lambda x:(-unique[x], x)) or min(initial)
    
    
    
    
    
    
    
    
